(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{88735:(e,n,t)=>{Promise.resolve().then(t.bind(t,91169))},91169:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>D});var o=t(95155),s=t(12115),r=t(93671),l=t(18403),c=t(70112),i=t(58887),a=t(81001),d=t(90557),h=t(49006),u=t(74115),x=t(78064);function j(e){let n=(0,s.useRef)(null),t=e.data.map((e,n,t)=>{let o=t.length-n-1;return{...e,i:-o}}),j=Object.keys(e.data[0]).filter(e=>"i"!==e),p=["indigo.6","red.6","green.6","blue.6","yellow.6","purple.6","cyan.6","teal.6","lime.6","pink.6"].slice(0,j.length),f=j.map((e,n)=>({name:e,color:p[n%p.length]}));return(0,o.jsxs)(l.Card,{children:[(0,o.jsxs)(c.Group,{children:[(0,o.jsx)(i.Text,{children:e.sensorkey.toUpperCase()}),(0,o.jsx)(a.ActionIcon,{color:"violet",onClick:()=>{(0,x.$E)(n.current,{cacheBust:!1}).then(e=>{let n=document.createElement("a");n.download="graph.png",n.href=e,n.click()}).catch(e=>{console.log(e)})},children:(0,o.jsx)(h.A,{})}),(0,o.jsx)(a.ActionIcon,{color:"green",onClick:()=>{let n=document.createElement("a");n.target="_blank",n.href="http://".concat(e.ip,"/").concat(encodeURIComponent(e.sensorkey),"/data.csv"),n.click()},children:(0,o.jsx)(u.A,{})})]}),(0,o.jsx)(d.Space,{h:"xs"}),(0,o.jsx)(r.b,{ref:n,h:400,data:t,dataKey:"i",series:f,withLegend:!0})]})}var p=t(31339),f=t(93695),g=t(63617),m=t(5821),k=t(53291),b=t(90892),C=t(8593),S=t(44644),w=t(53776),A=t(21220),I=t(30726),v=t(97649),y=t(64434),E=t(3653),L=t(28088),O=t(59511),P=t(67162),T=t(11681);function D(){let[e,n]=(0,s.useState)(null),[t,r]=(0,s.useState)(WebSocket.CLOSED),[l,h]=(0,s.useState)({}),[u,x]=(0,s.useState)(50),[D,{open:W,close:N}]=(0,T.useDisclosure)(!1),[_,R]=(0,s.useState)(""),F=(0,s.useRef)(u);F.current=u;let M=(0,I.M)({initialValue:"localhost:8080",validateOnChange:!1,validate:function(t){return new Promise(o=>{try{null==e||e.close(),h({});let s=new WebSocket("ws://".concat(t));n(s),o(null)}catch(n){n instanceof DOMException&&n.message.includes("insecure")&&(null==e||e.close(),W()),console.error(n.message),o("Can't reach wiresense client. Check if IP is valid and client can be reached!")}})}});return(0,s.useEffect)(()=>(e&&(e.onopen=()=>r(WebSocket.OPEN),e.onclose=()=>r(WebSocket.CLOSED),e.onmessage=e=>{var n=JSON.parse(e.data);let{key:t,data:o}=n;h(e=>{let n={...e};for(n[t]||(n[t]=[]),n[t].push(o);n[t].length>F.current;)n[t].shift();return n})},e.onerror=n=>{r(WebSocket.CLOSED),null==e||e.close()}),()=>{null==e||e.close(),h({})}),[e]),(0,s.useEffect)(()=>{R(window.location.href)},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.Affix,{position:{bottom:20,right:20},children:(0,o.jsx)(f.Anchor,{href:"https://github.com/Wiresense",children:(0,o.jsx)(a.ActionIcon,{variant:"filled",color:"black",children:(0,o.jsx)(v.A,{})})})}),(0,o.jsxs)(g.Modal,{opened:D,onClose:N,title:"Update Settings",centered:!0,children:[(0,o.jsx)(i.Text,{children:"Modern browsers prevent connections to ws (WebSocket) URLs when accessed from HTTPS sites due to security protocols. To resolve this issue and enable the tool&aps;s functionality, please follow our guides below to update your settings and allow these connections:"}),(0,o.jsxs)(m.Accordion,{multiple:!0,defaultValue:["undefined"!=typeof navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)?"chrominum":null,"undefined"!=typeof InstallTrigger?"firefox":null].filter(e=>""!==e),children:[(0,o.jsxs)(m.Accordion.Item,{value:"chrominum",children:[(0,o.jsx)(m.Accordion.Control,{icon:(0,o.jsx)(y.A,{}),children:"Chrome / Edge / Opera"}),(0,o.jsx)(m.Accordion.Panel,{children:(0,o.jsxs)(k.List,{type:"ordered",withPadding:!0,children:[(0,o.jsxs)(k.List.Item,{children:["Click on the padlock icon ",(0,o.jsx)(b.Code,{children:"\uD83D\uDD12"})," or the ",(0,o.jsx)(b.Code,{children:"Secure"})," label in the address bar."]}),(0,o.jsxs)(k.List.Item,{children:["Click on ",(0,o.jsx)(b.Code,{children:"Site settings"}),"; "]}),(0,o.jsxs)(k.List.Item,{children:["Under ",(0,o.jsx)(b.Code,{children:"Insecure conten"}),", select ",(0,o.jsx)(b.Code,{children:"Allow"})]}),(0,o.jsxs)(k.List.Item,{children:[(0,o.jsx)(f.Anchor,{href:_,children:"Reload"})," the page to apply settings."]})]})})]}),(0,o.jsxs)(m.Accordion.Item,{value:"firefox",children:[(0,o.jsx)(m.Accordion.Control,{icon:(0,o.jsx)(E.A,{}),children:"Firefox"}),(0,o.jsx)(m.Accordion.Panel,{children:(0,o.jsxs)(k.List,{type:"ordered",withPadding:!0,children:[(0,o.jsxs)(k.List.Item,{children:["Open Firefox and type ",(0,o.jsx)(b.Code,{children:"about:config"})," in the address bar, then press Enter."]}),(0,o.jsx)(k.List.Item,{children:"Accept the risk warning if prompted."}),(0,o.jsxs)(k.List.Item,{children:["Search for ",(0,o.jsx)(b.Code,{children:"network.websocket.allowInsecureFromHTTPS"}),"."]}),(0,o.jsxs)(k.List.Item,{children:["Set ",(0,o.jsx)(b.Code,{children:"network.websocket.allowInsecureFromHTTPS"})," to ",(0,o.jsx)(b.Code,{children:"true"})," by double-clicking it or using the context menu."]}),(0,o.jsxs)(k.List.Item,{children:[(0,o.jsx)(f.Anchor,{href:_,children:"Reload"})," the page to apply settings."]})]})})]})]}),(0,o.jsx)(d.Space,{h:"xs"}),(0,o.jsx)(i.Text,{children:"If you're uncertain about making changes, you can always revert them later after using the tool."})]}),(0,o.jsxs)(c.Group,{justify:"center",grow:!0,children:[(0,o.jsx)(C.TextInput,{required:!0,...M.getInputProps(),variant:"filled",label:"IP of the Wiresense Client",placeholder:"localhost:8080",rightSection:t===WebSocket.OPEN?(0,o.jsx)(a.ActionIcon,{onClick:function(){null==e||e.close(),h({})},color:"red",children:(0,o.jsx)(L.A,{})}):(0,o.jsx)(a.ActionIcon,{onClick:M.validate,children:(0,o.jsx)(O.A,{})}),leftSection:t===WebSocket.OPEN?(0,o.jsx)(P.A,{color:"green"}):(0,o.jsx)(L.A,{color:"red"})}),(0,o.jsx)(S.NumberInput,{value:u,onChange:e=>{e>=5&&e<=100&&x(e)},min:5,max:100,label:"Max. ammount of data per graph"})]}),(0,o.jsx)(w.Divider,{my:"md",label:"Settings"}),(0,o.jsx)(A.Stack,{align:"stretch",children:Object.entries(l).map(e=>{let[n,t]=e;return(0,o.jsx)(j,{sensorkey:n,data:t,ip:M.getValue()},n)})})]})}}},e=>{var n=n=>e(e.s=n);e.O(0,[545,498,341,441,684,358],()=>n(88735)),_N_E=e.O()}]);