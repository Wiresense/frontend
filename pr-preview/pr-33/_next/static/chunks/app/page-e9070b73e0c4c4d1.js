(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{99870:function(e,n,t){Promise.resolve().then(t.bind(t,78503))},78503:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return D}});var o=t(57437),s=t(2265),r=t(15937),c=t(24012),l=t(86608),i=t(96293),a=t(58323),d=t(6925),h=t(79842),u=t(45896),x=t(97293);function j(e){let n=(0,s.useRef)(null),t=e.data.map((e,n,t)=>{let o=t.length-n-1;return{...e,i:-o}}),j=Object.keys(e.data[0]).filter(e=>"i"!==e),p=["indigo.6","red.6","green.6","blue.6","yellow.6","purple.6","cyan.6","teal.6","lime.6","pink.6"].slice(0,j.length),f=j.map((e,n)=>({name:e,color:p[n%p.length]}));return(0,o.jsxs)(c.Card,{children:[(0,o.jsxs)(l.Group,{children:[(0,o.jsx)(i.Text,{children:e.sensorkey.toUpperCase()}),(0,o.jsx)(a.ActionIcon,{color:"violet",onClick:()=>{(0,x.YM)(n.current,{cacheBust:!1}).then(e=>{let n=document.createElement("a");n.download="graph.png",n.href=e,n.click()}).catch(e=>{console.log(e)})},children:(0,o.jsx)(h.Z,{})}),(0,o.jsx)(a.ActionIcon,{color:"green",onClick:()=>{let n=document.createElement("a");n.target="_blank",n.href="http://".concat(e.ip,"/").concat(encodeURIComponent(e.sensorkey),"/data.csv"),n.click()},children:(0,o.jsx)(u.Z,{})})]}),(0,o.jsx)(d.Space,{h:"xs"}),(0,o.jsx)(r.w,{ref:n,h:400,data:t,dataKey:"i",series:f,withLegend:!0})]})}var p=t(18849),f=t(22281),g=t(87520),m=t(80021),k=t(32924),b=t(31921),C=t(11736),S=t(75036),w=t(91601),I=t(70132),y=t(51888),v=t(96552),A=t(59629),E=t(91920),L=t(84926),O=t(43487),P=t(88220),T=t(93059);function D(){let[e,n]=(0,s.useState)(null),[t,r]=(0,s.useState)(WebSocket.CLOSED),[c,h]=(0,s.useState)({}),[u,x]=(0,s.useState)(50),[D,{open:W,close:Z}]=(0,T.useDisclosure)(!1),[N,_]=(0,s.useState)(""),R=(0,s.useRef)(u);R.current=u;let U=(0,y.U)({initialValue:"localhost:8080",validateOnChange:!1,validate:function(t){return new Promise(o=>{try{null==e||e.close(),h({});let s=new WebSocket("ws://".concat(t));n(s),o(null)}catch(n){n instanceof DOMException&&n.message.includes("insecure")&&(null==e||e.close(),W()),console.error(n.message),o("Can't reach wiresense client. Check if IP is valid and client can be reached!")}})}});return(0,s.useEffect)(()=>(e&&(e.onopen=()=>r(WebSocket.OPEN),e.onclose=()=>r(WebSocket.CLOSED),e.onmessage=e=>{(function(e){let{key:n,data:t}=e;h(e=>{let o={...e};for(o[n]||(o[n]=[]),o[n].push(t);o[n].length>R.current;)o[n].shift();return o})})(JSON.parse(e.data),u)},e.onerror=n=>{r(WebSocket.CLOSED),null==e||e.close()}),()=>{null==e||e.close(),h({})}),[e]),(0,s.useEffect)(()=>{_(window.location.href)},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.Affix,{position:{bottom:20,right:20},children:(0,o.jsx)(f.Anchor,{href:"https://github.com/Wiresense",children:(0,o.jsx)(a.ActionIcon,{variant:"filled",color:"black",children:(0,o.jsx)(v.Z,{})})})}),(0,o.jsxs)(g.Modal,{opened:D,onClose:Z,title:"Update Settings",centered:!0,children:[(0,o.jsx)(i.Text,{children:"Modern browsers prevent connections to ws (WebSocket) URLs when accessed from HTTPS sites due to security protocols. To resolve this issue and enable the tool&aps;s functionality, please follow our guides below to update your settings and allow these connections:"}),(0,o.jsxs)(m.Accordion,{multiple:!0,defaultValue:["undefined"!=typeof navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)?"chrominum":null,"undefined"!=typeof InstallTrigger?"firefox":null].filter(e=>""!==e),children:[(0,o.jsxs)(m.Accordion.Item,{value:"chrominum",children:[(0,o.jsx)(m.Accordion.Control,{icon:(0,o.jsx)(A.Z,{}),children:"Chrome / Edge / Opera"}),(0,o.jsx)(m.Accordion.Panel,{children:(0,o.jsxs)(k.List,{type:"ordered",withPadding:!0,children:[(0,o.jsxs)(k.List.Item,{children:["Click on the padlock icon ",(0,o.jsx)(b.Code,{children:"\uD83D\uDD12"})," or the ",(0,o.jsx)(b.Code,{children:"Secure"})," label in the address bar."]}),(0,o.jsxs)(k.List.Item,{children:["Click on ",(0,o.jsx)(b.Code,{children:"Site settings"}),"; "]}),(0,o.jsxs)(k.List.Item,{children:["Under ",(0,o.jsx)(b.Code,{children:"Insecure conten"}),", select ",(0,o.jsx)(b.Code,{children:"Allow"})]}),(0,o.jsxs)(k.List.Item,{children:[(0,o.jsx)(f.Anchor,{href:N,children:"Reload"})," the page to apply settings."]})]})})]}),(0,o.jsxs)(m.Accordion.Item,{value:"firefox",children:[(0,o.jsx)(m.Accordion.Control,{icon:(0,o.jsx)(E.Z,{}),children:"Firefox"}),(0,o.jsx)(m.Accordion.Panel,{children:(0,o.jsxs)(k.List,{type:"ordered",withPadding:!0,children:[(0,o.jsxs)(k.List.Item,{children:["Open Firefox and type ",(0,o.jsx)(b.Code,{children:"about:config"})," in the address bar, then press Enter."]}),(0,o.jsx)(k.List.Item,{children:"Accept the risk warning if prompted."}),(0,o.jsxs)(k.List.Item,{children:["Search for ",(0,o.jsx)(b.Code,{children:"network.websocket.allowInsecureFromHTTPS"}),"."]}),(0,o.jsxs)(k.List.Item,{children:["Set ",(0,o.jsx)(b.Code,{children:"network.websocket.allowInsecureFromHTTPS"})," to ",(0,o.jsx)(b.Code,{children:"true"})," by double-clicking it or using the context menu."]}),(0,o.jsxs)(k.List.Item,{children:[(0,o.jsx)(f.Anchor,{href:N,children:"Reload"})," the page to apply settings."]})]})})]})]}),(0,o.jsx)(d.Space,{h:"xs"}),(0,o.jsx)(i.Text,{children:"If you're uncertain about making changes, you can always revert them later after using the tool."})]}),(0,o.jsxs)(l.Group,{justify:"center",grow:!0,children:[(0,o.jsx)(C.TextInput,{required:!0,...U.getInputProps(),variant:"filled",label:"IP of the Wiresense Client",placeholder:"localhost:8080",rightSection:t===WebSocket.OPEN?(0,o.jsx)(a.ActionIcon,{onClick:function(){null==e||e.close(),h({})},color:"red",children:(0,o.jsx)(L.Z,{})}):(0,o.jsx)(a.ActionIcon,{onClick:U.validate,children:(0,o.jsx)(O.Z,{})}),leftSection:t===WebSocket.OPEN?(0,o.jsx)(P.Z,{color:"green"}):(0,o.jsx)(L.Z,{color:"red"})}),(0,o.jsx)(S.NumberInput,{value:u,onChange:e=>{e>=5&&e<=100&&x(e)},min:5,max:100,label:"Max. ammount of data per graph"})]}),(0,o.jsx)(w.Divider,{my:"md",label:"Settings"}),(0,o.jsx)(I.Stack,{align:"stretch",children:Object.entries(c).map(e=>{let[n,t]=e;return(0,o.jsx)(j,{sensorkey:n,data:t,ip:U.getValue()},n)})})]})}}},function(e){e.O(0,[19,573,971,23,744],function(){return e(e.s=99870)}),_N_E=e.O()}]);